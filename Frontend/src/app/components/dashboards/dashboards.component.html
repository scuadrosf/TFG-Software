<div class="page-wrapper">
    <div class="content">

        <!-- Page Header -->
        <div class="page-header">
            <div class="row">
                <div class="col-sm-12">
                    <ul class="breadcrumb">
                        <li class="breadcrumb-item"><a routerLink="/dashboard">Inicio </a></li>
                    </ul>
                </div>
            </div>
        </div>
        <!-- /Page Header -->

        <div class="good-morning-blk">
            <div class="row">
                <div class="col-md-6">
                    <div *ngIf="authService.isAdmin()" class="morning-user">
                        <!-- <h2 *ngIf="authService.currentUser().gender === 'Masculino'">Bienvenido de nuevo, <span>Dr. {{currentUser.lastName}}</span></h2> -->
                        <!-- <h2 *ngIf="authService.currentUser().gender === 'Femenino'">Bienvenida de nuevo, <span>Dr. {{currentUser.lastName}}</span></h2> -->
                        <h2>Bienvenido/a de nuevo, <span>Dr. {{authService.currentUser().lastName}}</span></h2>
                        <p>¿Sacamos una muelas?</p>
                    </div>
                    <div *ngIf="!authService.isAdmin()" class="morning-user">
                        <!-- <h2 *ngIf="authService.currentUser().gender === 'Masculino'">Bienvenido de nuevo, <span>{{currentUser.name}} {{currentUser.lastName}}</span></h2> -->
                        <!-- <h2 *ngIf="authService.currentUser().gender === 'Femenino'">Bienvenida de nuevo, <span>{{currentUser.name}} {{currentUser.lastName}}</span></h2> -->
                        <h2>Bienvenido/a de nuevo, <span>{{authService.currentUser().name}}
                                {{authService.currentUser().lastName}}</span></h2>

                        <p>¿Qué podemos hacer por ti?</p>
                    </div>
                </div>
                <div class="col-md-6 position-blk">
                    <div class="morning-img">
                        <img src="assets/img/morning-img-02.png" alt="">
                    </div>
                </div>
            </div>
        </div>

        <div class="doctor-list-blk" *ngIf="authService.isAdmin()">
            <div class="row">
                <div class="col-xl-4 col-md-6">
                    <div class="doctor-widget border-right-bg">
                        <div class="doctor-box-icon flex-shrink-0">
                            <img src="assets/img/icons/doctor-dash-01.svg" alt="">
                        </div>
                        <div class="doctor-content dash-count flex-grow-1">
                            <h4><span
                                    class="counter-up">{{numAppointmentsNoCompleted}}</span><span>/{{totalAppointmentsToday}}</span>
                                <span *ngIf="numAppointmentsNoCompleted <= 4 && numAppointmentsNoCompleted != 0"
                                    class="status-green">¡SIGUE ASÍ, NO QUEDA NADA!</span>
                                <span *ngIf="numAppointmentsNoCompleted > 4" class="status-pink">¡A POR ELLO!</span>
                                <span *ngIf="numAppointmentsNoCompleted == 0" class="status-green">TERMINAMOS POR
                                    HOY</span>
                            </h4>
                            <h5>Citas pendientes para hoy</h5>
                        </div>
                    </div>
                </div>
                <div class="col-xl-4 col-md-6">
                    <div class="doctor-widget border-right-bg">
                        <div class="doctor-box-icon flex-shrink-0">
                            <img src="assets/img/icons/doctor-dash-02.svg" alt="">
                        </div>
                        <div class="doctor-content dash-count flex-grow-1">
                            <h4><span class="counter-up">{{numAppointmentsCompleted}}</span><span></span>
                            </h4>
                            <h5>Consultas realizadas hoy</h5>
                        </div>
                    </div>
                </div>
                <div class="col-xl-4 col-md-6">
                    <div class="doctor-widget border-right-bg">
                        <div class="doctor-box-icon flex-shrink-0">
                            <img src="assets/img/icons/doctor-dash-03.svg" alt="">
                        </div>
                        <div class="doctor-content dash-count flex-grow-1">
                            <h4><span
                                    class="counter-up">{{numInterventions}}</span><span>/{{totalAppointmentsToday}}</span><span
                                    *ngIf="numInterventions>totalAppointmentsToday" class="status-green">¡WOW TE
                                    SUPERASTE!</span>
                            </h4>
                            <h5>Intervenciones realizadas hoy</h5>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div *ngIf="authService.isAdmin()">
            <div class="row">
                <div class="col-12 col-md-12 col-lg-6 col-xl-2 d-flex">

                    <div class="struct-point">
                        <div class="card wallet-widget">
                            <div class="circle-bar circle-bar2">
                                <div class="circle-graph2" data-percent="66">
                                    <b><img src="assets/img/icons/timer.svg" alt=""></b>
                                </div>
                            </div>
                            <div class="main-limit">
                                <p>Next Appointment in</p>
                                <h4>02h:12m</h4>
                            </div>
                        </div>
                        <div class="card patient-structure">
                            <div class="card-body">
                                <h5>Nuevos pacientes</h5>
                                <h3>{{newPatients}}<span class="status-green"><img
                                            src="assets/img/icons/sort-icon-01.svg" alt=""
                                            class="me-1">{{incrementRate}}%</span></h3>
                            </div>
                        </div>
                        <div class="card patient-structure">
                            <div class="card-body">
                                <h5>Pacientes</h5>
                                <h3>{{numPatientsTotal}}<span class="status-pink"><img
                                            src="assets/img/icons/sort-icon-02.svg" alt="" class="me-1">-20%</span></h3>
                            </div>
                        </div>

                    </div>

                </div>
                <div class="col-12 col-md-12 col-lg-6 col-xl-10 d-flex">
                    <div class="card flex-fill comman-shadow">
                        <div class="card-header">
                            <h4 class="card-title d-inline-block">Próximas citas</h4> <a routerLink="/appointment-list"
                                class="patient-views float-end">Ver todas</a>
                        </div>
                        <div class="card-body">
                            <div class="teaching-card">
                                <ul class="steps-history">
                                    <li>08:00</li>
                                    <li>10:00</li>
                                    <li>12:00</li>
                                    <li>14:00</li>
                                    <li>16:00</li>
                                    <li>18:00</li>
                                    <li>20:00</li>
                                </ul>
                                <ul class="activity-feed">
                                    <li class="feed-item d-flex align-items-center">
                                        <div class="dolor-activity hide-activity">
                                            <ul class="doctor-date-list mb-2">
                                                <li *ngFor="let appointment of appointmentsToday"
                                                    [ngClass]="{'stick-line':appointment.completed}"><i
                                                        class="fas fa-circle me-2"></i>{{appointment.fromDate |
                                                    slice:0:5 }}
                                                    <span>{{appointment.user.name}}</span>

                                                    <ng-container *ngIf="isCurrentAppointment(appointment)">
                                                        <div class="dropdown ongoing-blk">
                                                            <a href="#" class="dropdown-toggle active-doctor"
                                                                data-bs-toggle="dropdown">
                                                                <i class="fas fa-circle me-2 active-circles"></i>{{
                                                                appointment.fromDate | slice:0:5 }}
                                                                <span>{{ appointment.user.name }}</span>
                                                                <span class="ongoing-drapt">Ongoing <i
                                                                        class="feather-chevron-down ms-2"></i></span>
                                                            </a>
                                                            <ul class="doctor-sub-list dropdown-menu">
                                                                <!-- Contenido del dropdown aquí -->
                                                                <li class="dropdown-item">
                                                                    Hora<span>{{appointment.fromDate | slice:0:5}} -
                                                                        {{appointment.toDate | slice:0:5}}
                                                                        ({{timeOn(appointment)}}min) </span></li>
                                                                <li class="dropdown-item">
                                                                    Motivo<span>{{appointment.description}}</span></li>
                                                                <li class="schedule-blk mb-0 pt-2 dropdown-item">
                                                                    <ul class="nav schedule-time">
                                                                        <li><a
                                                                                (click)="deleteAppointment(appointment.id)"><img
                                                                                    src="assets/img/icons/trash.svg"
                                                                                    alt=""></a>
                                                                        </li>
                                                                        <li><a
                                                                                routerLink="/profile/{{appointment.user.id}}"><img
                                                                                    src="assets/img/icons/profile.svg"
                                                                                    alt=""></a>
                                                                        </li>
                                                                        <li><a
                                                                                routerLink="/edit-appointment/{{appointment.id}}"><img
                                                                                    src="assets/img/icons/edit.svg"
                                                                                    alt=""></a>
                                                                        </li>
                                                                    </ul>
                                                                </li>
                                                            </ul>
                                                        </div>
                                                    </ng-container>
                                                </li>
                                            </ul>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="notification-box">
        <div class="msg-sidebar notifications msg-noti">
            <div class="topnav-dropdown-header">
                <span>Messages</span>
            </div>
            <div class="drop-scroll msg-list-scroll" id="msg_list">
                <ul class="list-box">
                    <li>
                        <a href="chat.html">
                            <div class="list-item">
                                <div class="list-left">
                                    <span class="avatar">R</span>
                                </div>
                                <div class="list-body">
                                    <span class="message-author">Richard Miles </span>
                                    <span class="message-time">12:28 AM</span>
                                    <div class="clearfix"></div>
                                    <span class="message-content">Lorem ipsum dolor sit amet, consectetur
                                        adipiscing</span>
                                </div>
                            </div>
                        </a>
                    </li>
                    <li>
                        <a href="chat.html">
                            <div class="list-item new-message">
                                <div class="list-left">
                                    <span class="avatar">J</span>
                                </div>
                                <div class="list-body">
                                    <span class="message-author">John Doe</span>
                                    <span class="message-time">1 Aug</span>
                                    <div class="clearfix"></div>
                                    <span class="message-content">Lorem ipsum dolor sit amet, consectetur
                                        adipiscing</span>
                                </div>
                            </div>
                        </a>
                    </li>
                    <li>
                        <a href="chat.html">
                            <div class="list-item">
                                <div class="list-left">
                                    <span class="avatar">T</span>
                                </div>
                                <div class="list-body">
                                    <span class="message-author"> Tarah Shropshire </span>
                                    <span class="message-time">12:28 AM</span>
                                    <div class="clearfix"></div>
                                    <span class="message-content">Lorem ipsum dolor sit amet, consectetur
                                        adipiscing</span>
                                </div>
                            </div>
                        </a>
                    </li>
                    <li>
                        <a href="chat.html">
                            <div class="list-item">
                                <div class="list-left">
                                    <span class="avatar">M</span>
                                </div>
                                <div class="list-body">
                                    <span class="message-author">Mike Litorus</span>
                                    <span class="message-time">12:28 AM</span>
                                    <div class="clearfix"></div>
                                    <span class="message-content">Lorem ipsum dolor sit amet, consectetur
                                        adipiscing</span>
                                </div>
                            </div>
                        </a>
                    </li>
                    <li>
                        <a href="chat.html">
                            <div class="list-item">
                                <div class="list-left">
                                    <span class="avatar">C</span>
                                </div>
                                <div class="list-body">
                                    <span class="message-author"> Catherine Manseau </span>
                                    <span class="message-time">12:28 AM</span>
                                    <div class="clearfix"></div>
                                    <span class="message-content">Lorem ipsum dolor sit amet, consectetur
                                        adipiscing</span>
                                </div>
                            </div>
                        </a>
                    </li>
                    <li>
                        <a href="chat.html">
                            <div class="list-item">
                                <div class="list-left">
                                    <span class="avatar">D</span>
                                </div>
                                <div class="list-body">
                                    <span class="message-author"> Domenic Houston </span>
                                    <span class="message-time">12:28 AM</span>
                                    <div class="clearfix"></div>
                                    <span class="message-content">Lorem ipsum dolor sit amet, consectetur
                                        adipiscing</span>
                                </div>
                            </div>
                        </a>
                    </li>
                    <li>
                        <a href="chat.html">
                            <div class="list-item">
                                <div class="list-left">
                                    <span class="avatar">B</span>
                                </div>
                                <div class="list-body">
                                    <span class="message-author"> Buster Wigton </span>
                                    <span class="message-time">12:28 AM</span>
                                    <div class="clearfix"></div>
                                    <span class="message-content">Lorem ipsum dolor sit amet, consectetur
                                        adipiscing</span>
                                </div>
                            </div>
                        </a>
                    </li>
                    <li>
                        <a href="chat.html">
                            <div class="list-item">
                                <div class="list-left">
                                    <span class="avatar">R</span>
                                </div>
                                <div class="list-body">
                                    <span class="message-author"> Rolland Webber </span>
                                    <span class="message-time">12:28 AM</span>
                                    <div class="clearfix"></div>
                                    <span class="message-content">Lorem ipsum dolor sit amet, consectetur
                                        adipiscing</span>
                                </div>
                            </div>
                        </a>
                    </li>
                    <li>
                        <a href="chat.html">
                            <div class="list-item">
                                <div class="list-left">
                                    <span class="avatar">C</span>
                                </div>
                                <div class="list-body">
                                    <span class="message-author"> Claire Mapes </span>
                                    <span class="message-time">12:28 AM</span>
                                    <div class="clearfix"></div>
                                    <span class="message-content">Lorem ipsum dolor sit amet, consectetur
                                        adipiscing</span>
                                </div>
                            </div>
                        </a>
                    </li>
                    <li>
                        <a href="chat.html">
                            <div class="list-item">
                                <div class="list-left">
                                    <span class="avatar">M</span>
                                </div>
                                <div class="list-body">
                                    <span class="message-author">Melita Faucher</span>
                                    <span class="message-time">12:28 AM</span>
                                    <div class="clearfix"></div>
                                    <span class="message-content">Lorem ipsum dolor sit amet, consectetur
                                        adipiscing</span>
                                </div>
                            </div>
                        </a>
                    </li>
                    <li>
                        <a href="chat.html">
                            <div class="list-item">
                                <div class="list-left">
                                    <span class="avatar">J</span>
                                </div>
                                <div class="list-body">
                                    <span class="message-author">Jeffery Lalor</span>
                                    <span class="message-time">12:28 AM</span>
                                    <div class="clearfix"></div>
                                    <span class="message-content">Lorem ipsum dolor sit amet, consectetur
                                        adipiscing</span>
                                </div>
                            </div>
                        </a>
                    </li>
                    <li>
                        <a href="chat.html">
                            <div class="list-item">
                                <div class="list-left">
                                    <span class="avatar">L</span>
                                </div>
                                <div class="list-body">
                                    <span class="message-author">Loren Gatlin</span>
                                    <span class="message-time">12:28 AM</span>
                                    <div class="clearfix"></div>
                                    <span class="message-content">Lorem ipsum dolor sit amet, consectetur
                                        adipiscing</span>
                                </div>
                            </div>
                        </a>
                    </li>
                    <li>
                        <a href="chat.html">
                            <div class="list-item">
                                <div class="list-left">
                                    <span class="avatar">T</span>
                                </div>
                                <div class="list-body">
                                    <span class="message-author">Tarah Shropshire</span>
                                    <span class="message-time">12:28 AM</span>
                                    <div class="clearfix"></div>
                                    <span class="message-content">Lorem ipsum dolor sit amet, consectetur
                                        adipiscing</span>
                                </div>
                            </div>
                        </a>
                    </li>
                </ul>
            </div>
            <div class="topnav-dropdown-footer">
                <a href="chat.html">See all messages</a>
            </div>
        </div>
    </div>
</div>